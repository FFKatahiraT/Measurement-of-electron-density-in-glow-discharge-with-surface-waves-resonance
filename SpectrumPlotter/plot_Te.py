import numpy as np
import matplotlib.pyplot as plt

#define dataset
spec_Hg2 = 1.0553229796872026 #117V 3.7W
spec_Hg5 = 1.083463224623856 #175V 4.79W
spec_Hg8 = 0.6673742456383801 #181V 6.1W
spec_Hg11 = 0.8329615094821629 #229V 7.14W
spec_Hg14 = 0.8366990235616073 #306V 8.09W
spec_Hg17 = 0.8847561518685165 #368V 9.19W
spec_Hg18 = 0.7850808196986309 #381V 10.6W
spec_Hg19 = 0.8917078400547831 #439V 10.6W
spec_Hg20 = 0.8978328046813642 #509V 10.6W
spec_Hg21 = 0.9127942908928197 #573V 10.6W
spec_Hg22 = 0.8697454257211703 #602V 10.6W

spec_Hg8_1 = [5382.875163439398, 5382.875163439398] #181V 6.1W
spec_Hg11_1 = [6299.140762963169, 6299.140762963169, 11052.843191931877, 6299.140762963169, 11052.843191931877,
               6299.140762963169, 6299.140762963169, 3013.0590575109, 6299.140762963169, 3013.0590575109,
               11052.843191931877, 11052.843191931877, 3013.0590575109004, 3013.0590575109004] #229V 7.14W
spec_Hg14_1 = [6207.197649394248, 6207.197649394248, 11434.634190693612, 6207.197649394248, 11434.634190693612,
               6207.197649394248, 6207.197649394248, 2874.6932450530176, 6207.197649394248, 2874.6932450530176,
               11434.634190693612, 11434.634190693612, 2874.6932450530176, 2874.6932450530176] #306V 8.09W
spec_Hg17_1 = [6179.901096149542, 6179.901096149542, 11602.102313483185, 6179.901096149542, 11602.102313483185,
               6179.901096149542, 6179.901096149542, 11602.102313483185, 6179.901096149542, 6179.901096149542,
               2828.212342587602, 6179.901096149542, 6179.901096149542, 6179.901096149542, 2828.212342587602,
               11602.102313483183, 11602.102313483183, 11602.102313483183, 2828.212342587602, 2828.212342587602] #368V 9.19W
spec_Hg19_1 = [6183.202321100703,
               6183.202321100703,
11801.382851485341,
6183.202321100703,
11801.382851485341,
6183.202321100703,
6183.202321100703,
11801.382851485341,
6183.202321100703,
6183.202321100703,
2801.3914380263404,
6183.202321100703,
6183.202321100703,
6183.202321100703,
2801.3914380263404,
11801.382851485341,
11801.382851485341,
11801.382851485341,
2801.3914380263404,
2801.3914380263404] #439V 10.6W
spec_Hg20_1 = [6209.230897900506,
6209.230897900506,
11921.457560632549,
6209.230897900506,
11921.457560632549,
6209.230897900506,
6209.230897900506,
11921.457560632549,
6209.230897900506,
6209.230897900506,
2803.2201610580482,
6209.230897900506,
6209.230897900506,
6209.230897900506,
2803.2201610580482,
11921.457560632547,
11921.457560632547,
11921.457560632547,
2803.2201610580482,
2803.2201610580482] #509V 10.6W
spec_Hg21_1 = [6222.053025420489,
6222.053025420489,
12332.856532830878,
6222.053025420489,
12332.856532830878,
6222.053025420489,
6222.053025420489,
12332.856532830878,
6222.053025420489,
6222.053025420489,
2757.4445714028548,
6222.053025420489,
6222.053025420489,
6222.053025420489,
2757.4445714028548,
12332.856532830878,
12332.856532830878,
12332.856532830878,
2757.4445714028548,
2757.4445714028548] #573V 10.6W
spec_Hg22_1 = [7763.075818472287,
5519.301111166107,
7763.075818472287,
7763.075818472287,
7763.075818472287,
5519.301111166107]

data = [spec_Hg8, spec_Hg11, spec_Hg14, spec_Hg17, spec_Hg19, spec_Hg20, spec_Hg21, spec_Hg22]
x = [3.702272727272727, 4.5539772727272725, 5.911363636363636,
     7.004545454545455, 8.106534090909092, 9.254545454545454, 10.092613636363636, 10.432386363636363]
spec_Hg_total = [spec_Hg8_1, spec_Hg11_1, spec_Hg14_1, spec_Hg17_1, spec_Hg19_1, spec_Hg20_1, spec_Hg21_1, spec_Hg22_1]
std_error = []
for i in range(len(spec_Hg_total)):
    summ = 0
    for j in range(len(spec_Hg_total[i])):
        spec_Hg_total[i][j] /= 11600
        summ += (spec_Hg_total[i][j] - data[i])**2
    std_error.append((summ/len(spec_Hg_total[i]))**0.5)
    #spec_Hg19 = 18487.24400595866*0.00008617328149741 #Comsol
#spec_Hg20 = 17008.65317144406*0.00008617328149741 #Comsol
#spec_Hg21 = 16602.91059234494*0.00008617328149741 #Comsol
#spec_Hg22 = 16252.570644937872*0.00008617328149741 #Comsol
#spec_Hg23 = 15835.287469978759*0.00008617328149741 #Comsol
#spec_Hg24 = 15354.565472688262*0.00008617328149741 #Comsol
#spec_Hg25 = 14585.897371659288*0.00008617328149741 #Comsol


#data2 = [spec_Hg2, spec_Hg5, spec_Hg8, spec_Hg11, spec_Hg14, spec_Hg17, spec_Hg18, spec_Hg19, spec_Hg20, spec_Hg21,
#         spec_Hg22, spec_Hg23, spec_Hg24, spec_Hg25]
#calculate standard error

#std_error = 0.07
plt.rcParams.update({'font.size': 14})
fig, ax = plt.subplots()
print('err = ', std_error)
#voltage = [181, 241, 316, 381, 445, 514, 602]

y = data
x1 = [10.314, 8.6196, 6.9349, 5.2969, 3.7435] #Comsol
y1 = [0.8435082960685436, 0.8386750286060698, 0.8332480403391908, 0.8270352463004218, 0.8197383208661203] #Comsol


ax.errorbar(x, y,
 yerr = std_error,
 capsize = 4,
 fmt='o', ecolor='blue', label = 'Emission spectroscopy'
 )
plt.ylim(0,1.8)
plt.plot(x1,y1, color = 'red', label = 'Comsol Multiphysics')
plt.grid()
plt.legend(loc = "best")
plt.ylabel('Electron mean energy [eV]')
plt.xlabel('Power [W]')
plt.show()